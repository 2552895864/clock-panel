{"version":3,"sources":["../src/clock_ctrl.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAQ;;AACD;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGD,sBAAgB;AACpB,cAAM,MAAN;AACA,mBAAW,SAAX;AACA,kBAAU,MAAV;AACA,oBAAY,QAAZ;AACA,iBAAS,IAAT;AACA,0BAAkB,IAAlB;;;2BAGW;;;AACX,iBADW,SACX,CAAY,MAAZ,EAAoB,SAApB,EAA+B;gCADpB,WACoB;;6EADpB,sBAEH,QAAQ,YADe;;AAE7B,YAAE,QAAF,CAAW,MAAK,KAAL,EAAY,aAAvB,EAF6B;;AAI7B,gBAAK,WAAL,GAJ6B;;SAA/B;;qBADW;;wCAQG;;;AACZ,gBAAI,KAAK,KAAL,CAAW,IAAX,KAAoB,MAApB,EAA4B;AAC9B,mBAAK,IAAL,GAAY,KAAK,KAAL,CAAW,SAAX,KAAyB,SAAzB,GAAqC,SAAS,MAAT,CAAgB,UAAhB,CAArC,GAAmE,SAAS,MAAT,CAAgB,YAAhB,CAAnE,CADkB;aAAhC,MAEO;AACL,mBAAK,eAAL,GADK;aAFP;AAKA,iBAAK,QAAL,CAAc,YAAM;AAAE,qBAAK,WAAL,GAAF;aAAN,EAA+B,IAA7C,EANY;;;;4CASI;AAChB,gBAAI,CAAC,KAAK,KAAL,CAAW,gBAAX,EAA6B;AAChC,mBAAK,IAAL,GAAY,UAAZ,CADgC;aAAlC;;AAIA,gBAAM,MAAM,QAAN,CALU;AAMhB,gBAAM,WAAW,OAAO,QAAP,CAAgB,OAAO,KAAK,KAAL,CAAW,gBAAX,CAAP,CAAoC,IAApC,CAAyC,GAAzC,CAAhB,CAAX,CANU;AAOhB,gBAAM,oBAAoB,OAAO,GAAP,CAAW,SAAS,cAAT,EAAX,EAAsC,MAAtC,CAA6C,UAA7C,CAApB,CAPU;;AAShB,gBAAI,SAAS,MAAT,KAAoB,CAApB,EAAuB;AACzB,mBAAK,IAAL,GAAY,SAAS,IAAT,KAAkB,QAAlB,GAA6B,iBAA7B,CADa;aAA3B,MAEO,IAAI,SAAS,SAAT,KAAuB,CAAvB,EAA0B;AACnC,mBAAK,IAAL,GAAY,iBAAZ,CADmC;aAA9B,MAEA;AACL,mBAAK,IAAL,GAAY,UAAZ,CADK;aAFA;;;;yCAOM;AACb,uCApCS,sDAoCT,CADa;AAEb,iBAAK,YAAL,CAAkB,SAAlB,EAA6B,gDAA7B,EAA+E,CAA/E,EAFa;;;;eAnCJ;QAAkB;;;;AAyC/B,gBAAU,WAAV,GAAwB,aAAxB","file":"clock_ctrl.js","sourcesContent":["import {PanelCtrl} from 'app/plugins/sdk';\nimport moment from 'moment';\nimport _ from 'lodash';\nimport './css/clock-panel.css!';\n\nconst panelDefaults = {\n  mode: 'time',\n  clockType: '24 hour',\n  fontSize: '60px',\n  fontWeight: 'normal',\n  bgColor: null,\n  endCountdownTime: null\n};\n\nexport class ClockCtrl extends PanelCtrl {\n  constructor($scope, $injector) {\n    super($scope, $injector);\n    _.defaults(this.panel, panelDefaults);\n\n    this.updateClock();\n  }\n\n  updateClock() {\n    if (this.panel.mode === 'time') {\n      this.time = this.panel.clockType === '24 hour' ? moment().format('HH:mm:ss') : moment().format('hh:mm:ss A');\n    } else {\n      this.renderCountdown();\n    }\n    this.$timeout(() => { this.updateClock(); }, 1000);\n  }\n\n  renderCountdown() {\n    if (!this.panel.endCountdownTime) {\n      this.time = '00:00:00';\n    }\n\n    const now = moment();\n    const timeLeft = moment.duration(moment(this.panel.endCountdownTime).diff(now));\n    const formattedTimeLeft = moment.utc(timeLeft.asMilliseconds()).format('HH:mm:ss');\n\n    if (timeLeft.asDays() > 1) {\n      this.time = timeLeft.days() + ' days ' + formattedTimeLeft;\n    } else if (timeLeft.asSeconds() > 0) {\n      this.time = formattedTimeLeft;\n    } else {\n      this.time = '00:00:00';\n    }\n  }\n\n  initEditMode() {\n    super.initEditMode();\n    this.addEditorTab('Options', 'public/plugins/grafana-clock-panel/editor.html', 2);\n  }\n}\n\nClockCtrl.templateUrl = 'module.html';\n"]}